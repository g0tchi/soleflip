# SoleFlipper API Environment Configuration
# Copy this file to .env and update the values for your environment

# =============================================================================
# ENVIRONMENT SETTINGS
# =============================================================================
ENVIRONMENT=development  # development, staging, production, testing
DEBUG=true
TESTING=false

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================
# For PostgreSQL (Production/Staging)
DATABASE_URL=postgresql+asyncpg://username:password@localhost:5432/soleflip

# For SQLite (Development/Testing)
# DATABASE_URL=sqlite+aiosqlite:///./soleflip_dev.db

# Database Connection Pool Settings
SQL_ECHO=false
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=30
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=3600
DB_CONNECT_TIMEOUT=30

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================
# Encryption key for sensitive data (REQUIRED)
# Generate with: python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
FIELD_ENCRYPTION_KEY=your-32-byte-base64-encoded-key-here

# Application secret key
SECRET_KEY=your-secret-key-here

# CORS and Host Settings
ALLOWED_HOSTS=localhost,127.0.0.1,your-domain.com
CORS_ORIGINS=http://localhost:3000,https://your-frontend.com
CORS_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_HEADERS=*

# Request Limits
MAX_REQUEST_SIZE=52428800  # 50MB in bytes

# Rate Limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_PERIOD=60  # seconds

# =============================================================================
# API CONFIGURATION
# =============================================================================
API_TITLE=SoleFlipper API
API_VERSION=2.2.1
API_DESCRIPTION=Professional sneaker resale management system
API_HOST=0.0.0.0
API_PORT=8000
API_WORKERS=1
API_RELOAD=true
API_ACCESS_LOG=true

# API Documentation URLs
API_OPENAPI_URL=/openapi.json
API_DOCS_URL=/docs
API_REDOC_URL=/redoc

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================
LOG_LEVEL=INFO  # DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_FORMAT=json  # json or console
LOG_DATABASE_ENABLED=true
LOG_FILE_ENABLED=false
LOG_FILE_PATH=/var/log/soleflip/app.log
LOG_MAX_FILE_SIZE=10485760  # 10MB
LOG_BACKUP_COUNT=5
LOG_STRUCTURED=true

# =============================================================================
# EXTERNAL SERVICES
# =============================================================================

# --- StockX API Configuration ---
STOCKX_ENABLED=true
STOCKX_API_BASE_URL=https://api.stockx.com/v2
STOCKX_AUTH_URL=https://accounts.stockx.com/oauth/token
STOCKX_CLIENT_ID=your-stockx-client-id-here
STOCKX_CLIENT_SECRET=your-stockx-client-secret-here
STOCKX_TIMEOUT=30
STOCKX_RETRY_ATTEMPTS=3
STOCKX_RETRY_DELAY=1.0

# --- N8N Integration ---
N8N_ENABLED=false
N8N_WEBHOOK_URL=http://localhost:5678/webhook/soleflip
N8N_API_KEY=your-n8n-api-key

# --- Metabase Analytics ---
METABASE_ENABLED=true
METABASE_URL=http://localhost:6400
METABASE_USERNAME=your-metabase-username
METABASE_PASSWORD=your-metabase-password

# =============================================================================
# MONITORING & OBSERVABILITY
# =============================================================================
HEALTH_CHECK_ENABLED=true
METRICS_ENABLED=true
METRICS_PORT=8001

# --- Sentry Error Tracking ---
SENTRY_ENABLED=false
SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id
SENTRY_ENVIRONMENT=development
SENTRY_TRACES_SAMPLE_RATE=0.1

# =============================================================================
# CACHING CONFIGURATION
# =============================================================================

# --- Redis Cache ---
REDIS_ENABLED=true
REDIS_URL=redis://192.168.2.45:6379/0
# For password-protected Redis: redis://:password@localhost:6379/0
REDIS_TTL=3600  # seconds
REDIS_MAX_CONNECTIONS=10

# --- In-Memory Cache ---
MEMORY_CACHE_ENABLED=true
MEMORY_CACHE_SIZE=1000  # number of items
MEMORY_CACHE_TTL=300  # seconds

# =============================================================================
# DEVELOPMENT OVERRIDES (only used when ENVIRONMENT=development)
# =============================================================================
DEV_DATABASE_URL=sqlite+aiosqlite:///./soleflip_dev.db
DEV_DEBUG=true
DEV_API_RELOAD=true
DEV_LOG_LEVEL=DEBUG
DEV_CORS_ORIGINS=*

# =============================================================================
# PRODUCTION OVERRIDES (only used when ENVIRONMENT=production)
# =============================================================================
PROD_DEBUG=false
PROD_API_RELOAD=false
PROD_LOG_LEVEL=INFO
PROD_RATE_LIMIT_ENABLED=true
PROD_SENTRY_ENABLED=true
PROD_REDIS_ENABLED=true

# =============================================================================
# QUICKFLIP CONFIGURATION
# =============================================================================
# QuickFlip Arbitrage Detection System
QUICKFLIP_ENABLED=true
QUICKFLIP_MIN_PROFIT_MARGIN=15.0  # Minimum profit margin percentage
QUICKFLIP_MAX_PRICE_THRESHOLD=500.00  # Maximum price for opportunities
QUICKFLIP_AUTO_DETECTION=true  # Enable automatic detection
QUICKFLIP_DETECTION_INTERVAL=300  # Detection interval in seconds (5 minutes)
QUICKFLIP_MIN_PROFIT_AMOUNT=20.00  # Minimum absolute profit amount

# =============================================================================
# BUDIBASE INTEGRATION
# =============================================================================
# Low-Code Business Application Integration
BUDIBASE_ENABLED=true
BUDIBASE_API_URL=http://localhost:10000
BUDIBASE_APP_ID=your-budibase-app-id
BUDIBASE_API_KEY=your-budibase-api-key
BUDIBASE_TIMEOUT=30

# =============================================================================
# SUPPLIER MANAGEMENT
# =============================================================================
# Supplier Account Import and Management
SUPPLIER_IMPORT_ENABLED=true
SUPPLIER_VALIDATION_STRICT=false  # Enable strict validation
SUPPLIER_AUTO_SYNC=true  # Auto-sync supplier data
SUPPLIER_SYNC_INTERVAL=3600  # Sync interval in seconds (1 hour)
SUPPLIER_BATCH_SIZE=100  # Batch size for bulk operations

# =============================================================================
# DOCKER COMPOSE SPECIFIC SETTINGS
# =============================================================================
# These are automatically used when running with docker-compose
POSTGRES_USER=soleflip_user
POSTGRES_PASSWORD=secure_password_here
POSTGRES_DB=soleflip
POSTGRES_HOST=postgres
POSTGRES_PORT=5432

# Metabase Database (separate from main app database)
METABASE_DB_USER=metabase_user
METABASE_DB_PASSWORD=metabase_password_here
METABASE_DB_NAME=metabase
METABASE_DB_HOST=metabase-db
METABASE_DB_PORT=5432